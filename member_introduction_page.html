<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>12시간 전야제</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script type="module">
      // Firebase SDK 라이브러리 가져오기
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
      import { getFirestore } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
      import {
        collection,
        addDoc,
        getDocs,
        deleteDoc,
        doc,
        query,
        where,
      } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

      // Firebase 구성 정보 설정
      const firebaseConfig = {
        apiKey: "AIzaSyApxjU3BurTH6XuImY9_oUn3kk603w8PKc",
        authDomain: "test-8e09e.firebaseapp.com",
        projectId: "test-8e09e",
        storageBucket: "test-8e09e.appspot.com",
        messagingSenderId: "436344741102",
        appId: "1:436344741102:web:2bae246b9e85471b7867ff",
        measurementId: "G-KP8QWKQ6WF",
      };

      // Firebase 인스턴스 초기화
      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);

      $("#deletebtn").click(async function () {
        await deleteDoc(doc(db, "members", "7pmq1qut7I3xjGQ7GYvv"));
        alert("삭제완료");
      });
      // let deleteDoc = await deleteDoc(db, "members", "7pmq1qut7I3xjGQ7GYvv");

      let docs = await getDocs(collection(db, "members"));
      docs.forEach((doc) => {
        let row = doc.data();
        console.log(row);
        let imageUrl = row["imageUrl"];
        let memberName = row["memberName"];
        let tmi = row["tmi"];

        const result = query(
          collection(db, "members"),
          where("memberName", "==", memberName)
        );
        console.log("콘솔에 로그", result);
        let temp_html = `
          <div class="card" style="width: 18rem">
        <img src="${imageUrl}"
          class="card-img-top"
          alt="..."
        />
        <div class="card-body">
          <h5 class="card-title">${memberName}</h5>
          <p class="card-text">TMI : ${tmi}</p>
          <a href="#" class="btn btn-primary">수정</a>
          <a href="member_introduction_page.html" id="submitData" class="btn btn-secondary">삭제</a>
        </div>
      </div>`;
        $("#card").append(temp_html);
      });
      const result = query(
        collection(db, "members"),
        where("memberName", "==", memberName)
      );
      submitData.addEventListener("click", (e) => {
        deleteDoc(doc(db, "members", result));
        alert("삭제완료");
      });
    </script>

    <style>
      .mycontent {
        font-size: 35px;
        font-weight: 900;
      }
      .mysubcontent {
        background-color: beige;
        width: fit-content;
        font-size: 25px;
        font-weight: 500;
      }
    </style>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
  </head>
  <body
    style="
      display: flex;
      flex-direction: column;
      max-width: fit-content;
      margin: auto;
    "
  >
    <p style="text-align: center; font-size: 100px; color: rgb(223, 184, 111)">
      12시간 전야제
    </p>

    <div id="card" class="row row-cols-1 row-cols-md-4 g-4"></div>

    <br />
    <div>
      <button
        onclick="location.href='file:///C:/Users/gag97/OneDrive/Desktop/sparta/frontend/registere_page.html'"
      >
        멤버 등록하기
      </button>
    </div>
    <br />

    <button type="button" id="submitData">삭제</button>
    <br />
    <div style="text-align: center">
      <button
        onclick="location.href='file:///C:/Users/gag97/OneDrive/Desktop/sparta/frontend/team_introduction_page.html'"
        type="button"
        style="width: 200px; height: 70px"
      >
        <a style="font-size: 18px"> 팀 소개 페이지로 가기 </a>
      </button>
    </div>
  </body>
</html>
